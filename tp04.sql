USE COMPTA;

-- a.
SELECT
    *
FROM
    ARTICLE
ORDER BY
    DESIGNATION ASC;

-- b.
SELECT
    *
FROM
    ARTICLE
ORDER BY
    PRIX DESC;

-- c.
SELECT
    *
FROM
    ARTICLE
WHERE
    DESIGNATION LIKE 'BOULON%'
ORDER BY
    PRIX ASC;

-- d.
SELECT
    *
FROM
    ARTICLE
WHERE
    DESIGNATION LIKE '%SACHET%';

-- e.
SELECT
    *
FROM
    ARTICLE
WHERE
    LOWER(DESIGNATION) LIKE '%SACHET%';

-- f.
SELECT
    *
FROM
    ARTICLE,
    FOURNISSEUR
WHERE
    ARTICLE.ID_FOU = FOURNISSEUR.ID
ORDER BY
    FOURNISSEUR.NOM ASC,
    ARTICLE.PRIX DESC;

-- g.
SELECT
    *
FROM
    ARTICLE,
    FOURNISSEUR
WHERE
    ARTICLE.ID_FOU = FOURNISSEUR.ID
    AND FOURNISSEUR.NOM = 'Dubois & Fils';

-- h.
SELECT
    AVG(PRIX) AS MOYENNE_PRIX
FROM
    ARTICLE,
    FOURNISSEUR
WHERE
    ARTICLE.ID_FOU = FOURNISSEUR.ID
    AND FOURNISSEUR.NOM = 'Dubois & Fils';

-- i.
SELECT
    f.NOM,
    AVG(a.prix)
FROM
    ARTICLE a,
    FOURNISSUEUR f
WHERE
    a.ID_FOU = f.ID
GROUP BY
    f.NOM;

-- j.
SELECT
    *
FROM
    BON
WHERE
    date_cmde BETWEEN '2019-03-01' AND '2019-04-05 12:00:00'  '12:00:00';

-- k.
SELECT
    *
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID_FOU = COMPO.ID
    AND COMPO.ID = ARTICLE.ID_FOU
    AND DESIGNATION LIKE '%BOULON%';

-- l.
SELECT
    f.nom,
    a.designation
FROM
    BON,
    COMPO,
    ARTICLE,
    FOURNISSEUR
WHERE
    BON.ID = COMPO.ID_BON
    AND BON.ID_FOU = FOURNISSEUR.ID
    AND COMPO.ID_ART = ARTICLE.ID
    AND DESIGNATION like '%Boulon%';

-- m.
SELECT
    ID_BON,
    SUM(QTE * PRIX)
FROM
    BON,
    COMPO,
    ARTICLE
where
    BON.ID = COMPO.ID_BON
    and COMPO.ID_ART = ARTICLE.ID
GROUP BY
    ID_BON;

-- n.
SELECT
    ID_BON,
    SUM(QTE)
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID = COMPO.ID_BON
    AND COMPO.ID_ART = ARTICLE.ID
GROUP BY
    ID_BON;

-- o.
SELECT
    ID_BON,
    SUM(QTE)
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID = COMPO.ID_BON
    AND COMPO.ID_ART = ARTICLE.ID
GROUP BY
    ID_BON
HAVING
    SUM(QTE) > 25;

-- p.
SELECT
    ID_BON,
    SUM(QTE * PRIX)
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID = COMPO.ID_BON
    AND COMPO.ID_ART = ARTICLE.ID
    AND MONTH (date_cmde) = 4;

SELECT
    * ARTICLE
FROM