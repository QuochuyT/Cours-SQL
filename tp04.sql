USE COMPTA;

SELECT
    *
FROM
    ARTICLE
ORDER BY
    DESIGNATION ASC;

SELECT
    *
FROM
    ARTICLE
ORDER BY
    PRIX DESC;

SELECT
    *
FROM
    ARTICLE
WHERE
    DESIGNATION LIKE 'BOULON%'
ORDER BY
    PRIX ASC;

SELECT
    *
FROM
    ARTICLE
WHERE
    DESIGNATION LIKE '%SACHET%';

SELECT
    *
FROM
    ARTICLE
WHERE
    LOWER(DESIGNATION) LIKE '%SACHET%';

SELECT
    *
FROM
    ARTICLE,
    FOURNISSEUR
WHERE
    ARTICLE.ID_FOU = FOURNISSEUR.ID
ORDER BY
    FOURNISSEUR.NOM ASC,
    ARTICLE.PRIX DESC;

SELECT
    *
FROM
    ARTICLE,
    FOURNISSEUR
WHERE
    ARTICLE.ID_FOU = FOURNISSEUR.ID
    AND FOURNISSEUR.NOM = 'Dubois & Fils';

SELECT
    NOM,
    AVG(PRIX)
FROM
    ARTICLE,
    FOURNISSEUR
WHERE
    ARTICLE.ID_FOU = FOURNISSEUR.ID
    AND FOURNISSEUR.NOM = 'Dubois & Fils'
ORDER BY
    FOURNISSEUR.NOM ASC,
    ARTICLE.PRIX DESC;

SELECT
    AVG(PRIX)
FROM
    ARTICLE,
    FOURNISSEUR
WHERE
    ARTICLE.ID_FOU = FOURNISSEUR.ID
GROUP BY
    FOURNISSEUR.NOM;

SELECT
    *
FROM
    bon
WHERE
    date_cmde BETWEEN '2019-03-01' AND '2019-04-05 12:00:00';

SELECT DISTINCT
    BON.NUMERO
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID = COMPO.ID_ART
    AND COMPO.ID_ART = ARTICLE.ID
    AND LOWER(DESIGNATION) LIKE '%BOULON%';

SELECT DISTINCT
    BON.NUMERO,
    FOURNISSEUR.NOM
FROM
    BON,
    COMPO,
    ARTICLE,
    FOURNISSEUR
WHERE
    BON.ID = COMPO.ID_BON
    AND BON.ID_FOU = FOURNISSEUR.ID
    AND COMPO.ID_ART = ARTICLE.ID
    AND DESIGNATION like '%Boulon%';

SELECT
    ID_BON,
    SUM(QTE * PRIX)
FROM
    BON,
    COMPO,
    ARTICLE
where
    BON.ID = COMPO.ID_BON
    and COMPO.ID_ART = ARTICLE.ID
GROUP BY
    ID_BON;

SELECT
    ID_BON,
    SUM(QTE)
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID = COMPO.ID_BON
    AND COMPO.ID_ART = ARTICLE.ID
GROUP BY
    ID_BON;

SELECT
    ID_BON,
    SUM(QTE)
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID = COMPO.ID_BON
    AND COMPO.ID_ART = ARTICLE.ID
GROUP BY
    ID_BON
HAVING
    SUM(QTE) > 25;

SELECT
    ID_BON,
    SUM(QTE * PRIX)
FROM
    BON,
    COMPO,
    ARTICLE
WHERE
    BON.ID = COMPO.ID_BON
    AND COMPO.ID_ART = ARTICLE.ID
    AND MONTH (date_cmde) = 4;